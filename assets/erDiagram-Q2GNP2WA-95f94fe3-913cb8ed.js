import { g } from "./chunk-55IACEB6-b744bec0-193174fb.js";
import { d } from "./chunk-QN33PNHL-94a673b4-a55ff094.js";
import { H as m, aw as Qv, M as R, O as yt, at as XI, au as VI, a6 as gt, aq as $e, a7 as $5, a8 as B5, aa as F5, a9 as D5, ak as R5, al as I5, ar as M5, ap as OI, av as dn } from "./app-c48027fd.js";
import { e } from "./channel-4b3ee778-31a2307e.js";
import "./chakra-ui-1d60df8d.js";
import "./react-utils-0e8f4d03.js";
import "./monaco-45e206c0.js";
import "./vendor-75a482ef.js";
import "./common-utils-40e9b830.js";
var pt = function() {
  var i = /* @__PURE__ */ m(function(R2, n, a, o) {
    for (a = a || {}, o = R2.length; o--; a[R2[o]] = n)
      ;
    return a;
  }, "o"), s = [6, 8, 10, 22, 24, 26, 28, 33, 34, 35, 36, 37, 40, 43, 44, 50], h = [1, 10], p = [1, 11], l = [1, 12], c = [1, 13], y = [1, 20], f = [1, 21], E = [1, 22], w = [1, 23], Z = [1, 24], S = [1, 19], et = [1, 25], U = [1, 26], T = [1, 18], V = [1, 33], it = [1, 34], st = [1, 35], rt = [1, 36], nt = [1, 37], dt = [6, 8, 10, 13, 15, 17, 20, 21, 22, 24, 26, 28, 33, 34, 35, 36, 37, 40, 43, 44, 50, 63, 64, 65, 66, 67], O = [1, 42], A = [1, 43], L = [1, 52], M = [40, 50, 68, 69], B = [1, 63], F = [1, 61], N = [1, 58], Y = [1, 62], P = [1, 64], j = [6, 8, 10, 13, 17, 22, 24, 26, 28, 33, 34, 35, 36, 37, 40, 41, 42, 43, 44, 48, 49, 50, 63, 64, 65, 66, 67], mt = [63, 64, 65, 66, 67], yt2 = [1, 81], ft = [1, 80], _t = [1, 78], gt2 = [1, 79], bt = [6, 10, 42, 47], v = [6, 10, 13, 41, 42, 47, 48, 49], W = [1, 89], Q = [1, 88], X = [1, 87], z = [19, 56], Et = [1, 98], kt = [1, 97], at = [19, 56, 58, 60], ot = {
    trace: /* @__PURE__ */ m(function() {
    }, "trace"),
    yy: {},
    symbols_: { error: 2, start: 3, ER_DIAGRAM: 4, document: 5, EOF: 6, line: 7, SPACE: 8, statement: 9, NEWLINE: 10, entityName: 11, relSpec: 12, COLON: 13, role: 14, STYLE_SEPARATOR: 15, idList: 16, BLOCK_START: 17, attributes: 18, BLOCK_STOP: 19, SQS: 20, SQE: 21, title: 22, title_value: 23, acc_title: 24, acc_title_value: 25, acc_descr: 26, acc_descr_value: 27, acc_descr_multiline_value: 28, direction: 29, classDefStatement: 30, classStatement: 31, styleStatement: 32, direction_tb: 33, direction_bt: 34, direction_rl: 35, direction_lr: 36, CLASSDEF: 37, stylesOpt: 38, separator: 39, UNICODE_TEXT: 40, STYLE_TEXT: 41, COMMA: 42, CLASS: 43, STYLE: 44, style: 45, styleComponent: 46, SEMI: 47, NUM: 48, BRKT: 49, ENTITY_NAME: 50, attribute: 51, attributeType: 52, attributeName: 53, attributeKeyTypeList: 54, attributeComment: 55, ATTRIBUTE_WORD: 56, attributeKeyType: 57, ",": 58, ATTRIBUTE_KEY: 59, COMMENT: 60, cardinality: 61, relType: 62, ZERO_OR_ONE: 63, ZERO_OR_MORE: 64, ONE_OR_MORE: 65, ONLY_ONE: 66, MD_PARENT: 67, NON_IDENTIFYING: 68, IDENTIFYING: 69, WORD: 70, $accept: 0, $end: 1 },
    terminals_: { 2: "error", 4: "ER_DIAGRAM", 6: "EOF", 8: "SPACE", 10: "NEWLINE", 13: "COLON", 15: "STYLE_SEPARATOR", 17: "BLOCK_START", 19: "BLOCK_STOP", 20: "SQS", 21: "SQE", 22: "title", 23: "title_value", 24: "acc_title", 25: "acc_title_value", 26: "acc_descr", 27: "acc_descr_value", 28: "acc_descr_multiline_value", 33: "direction_tb", 34: "direction_bt", 35: "direction_rl", 36: "direction_lr", 37: "CLASSDEF", 40: "UNICODE_TEXT", 41: "STYLE_TEXT", 42: "COMMA", 43: "CLASS", 44: "STYLE", 47: "SEMI", 48: "NUM", 49: "BRKT", 50: "ENTITY_NAME", 56: "ATTRIBUTE_WORD", 58: ",", 59: "ATTRIBUTE_KEY", 60: "COMMENT", 63: "ZERO_OR_ONE", 64: "ZERO_OR_MORE", 65: "ONE_OR_MORE", 66: "ONLY_ONE", 67: "MD_PARENT", 68: "NON_IDENTIFYING", 69: "IDENTIFYING", 70: "WORD" },
    productions_: [0, [3, 3], [5, 0], [5, 2], [7, 2], [7, 1], [7, 1], [7, 1], [9, 5], [9, 9], [9, 7], [9, 7], [9, 4], [9, 6], [9, 3], [9, 5], [9, 1], [9, 3], [9, 7], [9, 9], [9, 6], [9, 8], [9, 4], [9, 6], [9, 2], [9, 2], [9, 2], [9, 1], [9, 1], [9, 1], [9, 1], [9, 1], [29, 1], [29, 1], [29, 1], [29, 1], [30, 4], [16, 1], [16, 1], [16, 3], [16, 3], [31, 3], [32, 4], [38, 1], [38, 3], [45, 1], [45, 2], [39, 1], [39, 1], [39, 1], [46, 1], [46, 1], [46, 1], [46, 1], [11, 1], [11, 1], [18, 1], [18, 2], [51, 2], [51, 3], [51, 3], [51, 4], [52, 1], [53, 1], [54, 1], [54, 3], [57, 1], [55, 1], [12, 3], [61, 1], [61, 1], [61, 1], [61, 1], [61, 1], [62, 1], [62, 1], [14, 1], [14, 1], [14, 1]],
    performAction: /* @__PURE__ */ m(function(n, a, o, r, d2, t, G) {
      var e2 = t.length - 1;
      switch (d2) {
        case 1:
          break;
        case 2:
          this.$ = [];
          break;
        case 3:
          t[e2 - 1].push(t[e2]), this.$ = t[e2 - 1];
          break;
        case 4:
        case 5:
          this.$ = t[e2];
          break;
        case 6:
        case 7:
          this.$ = [];
          break;
        case 8:
          r.addEntity(t[e2 - 4]), r.addEntity(t[e2 - 2]), r.addRelationship(t[e2 - 4], t[e2], t[e2 - 2], t[e2 - 3]);
          break;
        case 9:
          r.addEntity(t[e2 - 8]), r.addEntity(t[e2 - 4]), r.addRelationship(t[e2 - 8], t[e2], t[e2 - 4], t[e2 - 5]), r.setClass([t[e2 - 8]], t[e2 - 6]), r.setClass([t[e2 - 4]], t[e2 - 2]);
          break;
        case 10:
          r.addEntity(t[e2 - 6]), r.addEntity(t[e2 - 2]), r.addRelationship(t[e2 - 6], t[e2], t[e2 - 2], t[e2 - 3]), r.setClass([t[e2 - 6]], t[e2 - 4]);
          break;
        case 11:
          r.addEntity(t[e2 - 6]), r.addEntity(t[e2 - 4]), r.addRelationship(t[e2 - 6], t[e2], t[e2 - 4], t[e2 - 5]), r.setClass([t[e2 - 4]], t[e2 - 2]);
          break;
        case 12:
          r.addEntity(t[e2 - 3]), r.addAttributes(t[e2 - 3], t[e2 - 1]);
          break;
        case 13:
          r.addEntity(t[e2 - 5]), r.addAttributes(t[e2 - 5], t[e2 - 1]), r.setClass([t[e2 - 5]], t[e2 - 3]);
          break;
        case 14:
          r.addEntity(t[e2 - 2]);
          break;
        case 15:
          r.addEntity(t[e2 - 4]), r.setClass([t[e2 - 4]], t[e2 - 2]);
          break;
        case 16:
          r.addEntity(t[e2]);
          break;
        case 17:
          r.addEntity(t[e2 - 2]), r.setClass([t[e2 - 2]], t[e2]);
          break;
        case 18:
          r.addEntity(t[e2 - 6], t[e2 - 4]), r.addAttributes(t[e2 - 6], t[e2 - 1]);
          break;
        case 19:
          r.addEntity(t[e2 - 8], t[e2 - 6]), r.addAttributes(t[e2 - 8], t[e2 - 1]), r.setClass([t[e2 - 8]], t[e2 - 3]);
          break;
        case 20:
          r.addEntity(t[e2 - 5], t[e2 - 3]);
          break;
        case 21:
          r.addEntity(t[e2 - 7], t[e2 - 5]), r.setClass([t[e2 - 7]], t[e2 - 2]);
          break;
        case 22:
          r.addEntity(t[e2 - 3], t[e2 - 1]);
          break;
        case 23:
          r.addEntity(t[e2 - 5], t[e2 - 3]), r.setClass([t[e2 - 5]], t[e2]);
          break;
        case 24:
        case 25:
          this.$ = t[e2].trim(), r.setAccTitle(this.$);
          break;
        case 26:
        case 27:
          this.$ = t[e2].trim(), r.setAccDescription(this.$);
          break;
        case 32:
          r.setDirection("TB");
          break;
        case 33:
          r.setDirection("BT");
          break;
        case 34:
          r.setDirection("RL");
          break;
        case 35:
          r.setDirection("LR");
          break;
        case 36:
          this.$ = t[e2 - 3], r.addClass(t[e2 - 2], t[e2 - 1]);
          break;
        case 37:
        case 38:
        case 56:
        case 64:
          this.$ = [t[e2]];
          break;
        case 39:
        case 40:
          this.$ = t[e2 - 2].concat([t[e2]]);
          break;
        case 41:
          this.$ = t[e2 - 2], r.setClass(t[e2 - 1], t[e2]);
          break;
        case 42:
          this.$ = t[e2 - 3], r.addCssStyles(t[e2 - 2], t[e2 - 1]);
          break;
        case 43:
          this.$ = [t[e2]];
          break;
        case 44:
          t[e2 - 2].push(t[e2]), this.$ = t[e2 - 2];
          break;
        case 46:
          this.$ = t[e2 - 1] + t[e2];
          break;
        case 54:
        case 76:
        case 77:
          this.$ = t[e2].replace(/"/g, "");
          break;
        case 55:
        case 78:
          this.$ = t[e2];
          break;
        case 57:
          t[e2].push(t[e2 - 1]), this.$ = t[e2];
          break;
        case 58:
          this.$ = { type: t[e2 - 1], name: t[e2] };
          break;
        case 59:
          this.$ = { type: t[e2 - 2], name: t[e2 - 1], keys: t[e2] };
          break;
        case 60:
          this.$ = { type: t[e2 - 2], name: t[e2 - 1], comment: t[e2] };
          break;
        case 61:
          this.$ = { type: t[e2 - 3], name: t[e2 - 2], keys: t[e2 - 1], comment: t[e2] };
          break;
        case 62:
        case 63:
        case 66:
          this.$ = t[e2];
          break;
        case 65:
          t[e2 - 2].push(t[e2]), this.$ = t[e2 - 2];
          break;
        case 67:
          this.$ = t[e2].replace(/"/g, "");
          break;
        case 68:
          this.$ = { cardA: t[e2], relType: t[e2 - 1], cardB: t[e2 - 2] };
          break;
        case 69:
          this.$ = r.Cardinality.ZERO_OR_ONE;
          break;
        case 70:
          this.$ = r.Cardinality.ZERO_OR_MORE;
          break;
        case 71:
          this.$ = r.Cardinality.ONE_OR_MORE;
          break;
        case 72:
          this.$ = r.Cardinality.ONLY_ONE;
          break;
        case 73:
          this.$ = r.Cardinality.MD_PARENT;
          break;
        case 74:
          this.$ = r.Identification.NON_IDENTIFYING;
          break;
        case 75:
          this.$ = r.Identification.IDENTIFYING;
          break;
      }
    }, "anonymous"),
    table: [{ 3: 1, 4: [1, 2] }, { 1: [3] }, i(s, [2, 2], { 5: 3 }), { 6: [1, 4], 7: 5, 8: [1, 6], 9: 7, 10: [1, 8], 11: 9, 22: h, 24: p, 26: l, 28: c, 29: 14, 30: 15, 31: 16, 32: 17, 33: y, 34: f, 35: E, 36: w, 37: Z, 40: S, 43: et, 44: U, 50: T }, i(s, [2, 7], { 1: [2, 1] }), i(s, [2, 3]), { 9: 27, 11: 9, 22: h, 24: p, 26: l, 28: c, 29: 14, 30: 15, 31: 16, 32: 17, 33: y, 34: f, 35: E, 36: w, 37: Z, 40: S, 43: et, 44: U, 50: T }, i(s, [2, 5]), i(s, [2, 6]), i(s, [2, 16], { 12: 28, 61: 32, 15: [1, 29], 17: [1, 30], 20: [1, 31], 63: V, 64: it, 65: st, 66: rt, 67: nt }), { 23: [1, 38] }, { 25: [1, 39] }, { 27: [1, 40] }, i(s, [2, 27]), i(s, [2, 28]), i(s, [2, 29]), i(s, [2, 30]), i(s, [2, 31]), i(dt, [2, 54]), i(dt, [2, 55]), i(s, [2, 32]), i(s, [2, 33]), i(s, [2, 34]), i(s, [2, 35]), { 16: 41, 40: O, 41: A }, { 16: 44, 40: O, 41: A }, { 16: 45, 40: O, 41: A }, i(s, [2, 4]), { 11: 46, 40: S, 50: T }, { 16: 47, 40: O, 41: A }, { 18: 48, 19: [1, 49], 51: 50, 52: 51, 56: L }, { 11: 53, 40: S, 50: T }, { 62: 54, 68: [1, 55], 69: [1, 56] }, i(M, [2, 69]), i(M, [2, 70]), i(M, [2, 71]), i(M, [2, 72]), i(M, [2, 73]), i(s, [2, 24]), i(s, [2, 25]), i(s, [2, 26]), { 13: B, 38: 57, 41: F, 42: N, 45: 59, 46: 60, 48: Y, 49: P }, i(j, [2, 37]), i(j, [2, 38]), { 16: 65, 40: O, 41: A, 42: N }, { 13: B, 38: 66, 41: F, 42: N, 45: 59, 46: 60, 48: Y, 49: P }, { 13: [1, 67], 15: [1, 68] }, i(s, [2, 17], { 61: 32, 12: 69, 17: [1, 70], 42: N, 63: V, 64: it, 65: st, 66: rt, 67: nt }), { 19: [1, 71] }, i(s, [2, 14]), { 18: 72, 19: [2, 56], 51: 50, 52: 51, 56: L }, { 53: 73, 56: [1, 74] }, { 56: [2, 62] }, { 21: [1, 75] }, { 61: 76, 63: V, 64: it, 65: st, 66: rt, 67: nt }, i(mt, [2, 74]), i(mt, [2, 75]), { 6: yt2, 10: ft, 39: 77, 42: _t, 47: gt2 }, { 40: [1, 82], 41: [1, 83] }, i(bt, [2, 43], { 46: 84, 13: B, 41: F, 48: Y, 49: P }), i(v, [2, 45]), i(v, [2, 50]), i(v, [2, 51]), i(v, [2, 52]), i(v, [2, 53]), i(s, [2, 41], { 42: N }), { 6: yt2, 10: ft, 39: 85, 42: _t, 47: gt2 }, { 14: 86, 40: W, 50: Q, 70: X }, { 16: 90, 40: O, 41: A }, { 11: 91, 40: S, 50: T }, { 18: 92, 19: [1, 93], 51: 50, 52: 51, 56: L }, i(s, [2, 12]), { 19: [2, 57] }, i(z, [2, 58], { 54: 94, 55: 95, 57: 96, 59: Et, 60: kt }), i([19, 56, 59, 60], [2, 63]), i(s, [2, 22], { 15: [1, 100], 17: [1, 99] }), i([40, 50], [2, 68]), i(s, [2, 36]), { 13: B, 41: F, 45: 101, 46: 60, 48: Y, 49: P }, i(s, [2, 47]), i(s, [2, 48]), i(s, [2, 49]), i(j, [2, 39]), i(j, [2, 40]), i(v, [2, 46]), i(s, [2, 42]), i(s, [2, 8]), i(s, [2, 76]), i(s, [2, 77]), i(s, [2, 78]), { 13: [1, 102], 42: N }, { 13: [1, 104], 15: [1, 103] }, { 19: [1, 105] }, i(s, [2, 15]), i(z, [2, 59], { 55: 106, 58: [1, 107], 60: kt }), i(z, [2, 60]), i(at, [2, 64]), i(z, [2, 67]), i(at, [2, 66]), { 18: 108, 19: [1, 109], 51: 50, 52: 51, 56: L }, { 16: 110, 40: O, 41: A }, i(bt, [2, 44], { 46: 84, 13: B, 41: F, 48: Y, 49: P }), { 14: 111, 40: W, 50: Q, 70: X }, { 16: 112, 40: O, 41: A }, { 14: 113, 40: W, 50: Q, 70: X }, i(s, [2, 13]), i(z, [2, 61]), { 57: 114, 59: Et }, { 19: [1, 115] }, i(s, [2, 20]), i(s, [2, 23], { 17: [1, 116], 42: N }), i(s, [2, 11]), { 13: [1, 117], 42: N }, i(s, [2, 10]), i(at, [2, 65]), i(s, [2, 18]), { 18: 118, 19: [1, 119], 51: 50, 52: 51, 56: L }, { 14: 120, 40: W, 50: Q, 70: X }, { 19: [1, 121] }, i(s, [2, 21]), i(s, [2, 9]), i(s, [2, 19])],
    defaultActions: { 52: [2, 62], 72: [2, 57] },
    parseError: /* @__PURE__ */ m(function(n, a) {
      if (a.recoverable)
        this.trace(n);
      else {
        var o = new Error(n);
        throw o.hash = a, o;
      }
    }, "parseError"),
    parse: /* @__PURE__ */ m(function(n) {
      var a = this, o = [0], r = [], d2 = [null], t = [], G = this.table, e2 = "", H = 0, St = 0, It = 2, Tt = 1, xt = t.slice.call(arguments, 1), m$1 = Object.create(this.lexer), I = { yy: {} };
      for (var ct in this.yy)
        Object.prototype.hasOwnProperty.call(this.yy, ct) && (I.yy[ct] = this.yy[ct]);
      m$1.setInput(n, I.yy), I.yy.lexer = m$1, I.yy.parser = this, typeof m$1.yylloc > "u" && (m$1.yylloc = {});
      var lt = m$1.yylloc;
      t.push(lt);
      var vt = m$1.options && m$1.options.ranges;
      typeof I.yy.parseError == "function" ? this.parseError = I.yy.parseError : this.parseError = Object.getPrototypeOf(this).parseError;
      function Ct(g2) {
        o.length = o.length - 2 * g2, d2.length = d2.length - g2, t.length = t.length - g2;
      }
      m(Ct, "popStack");
      function Ot() {
        var g2;
        return g2 = r.pop() || m$1.lex() || Tt, typeof g2 != "number" && (g2 instanceof Array && (r = g2, g2 = r.pop()), g2 = a.symbols_[g2] || g2), g2;
      }
      m(Ot, "lex");
      for (var _, x, b, ht, C = {}, J, k, At, $; ; ) {
        if (x = o[o.length - 1], this.defaultActions[x] ? b = this.defaultActions[x] : ((_ === null || typeof _ > "u") && (_ = Ot()), b = G[x] && G[x][_]), typeof b > "u" || !b.length || !b[0]) {
          var ut = "";
          $ = [];
          for (J in G[x])
            this.terminals_[J] && J > It && $.push("'" + this.terminals_[J] + "'");
          m$1.showPosition ? ut = "Parse error on line " + (H + 1) + `:
` + m$1.showPosition() + `
Expecting ` + $.join(", ") + ", got '" + (this.terminals_[_] || _) + "'" : ut = "Parse error on line " + (H + 1) + ": Unexpected " + (_ == Tt ? "end of input" : "'" + (this.terminals_[_] || _) + "'"), this.parseError(ut, {
            text: m$1.match,
            token: this.terminals_[_] || _,
            line: m$1.yylineno,
            loc: lt,
            expected: $
          });
        }
        if (b[0] instanceof Array && b.length > 1)
          throw new Error("Parse Error: multiple actions possible at state: " + x + ", token: " + _);
        switch (b[0]) {
          case 1:
            o.push(_), d2.push(m$1.yytext), t.push(m$1.yylloc), o.push(b[1]), _ = null, St = m$1.yyleng, e2 = m$1.yytext, H = m$1.yylineno, lt = m$1.yylloc;
            break;
          case 2:
            if (k = this.productions_[b[1]][1], C.$ = d2[d2.length - k], C._$ = {
              first_line: t[t.length - (k || 1)].first_line,
              last_line: t[t.length - 1].last_line,
              first_column: t[t.length - (k || 1)].first_column,
              last_column: t[t.length - 1].last_column
            }, vt && (C._$.range = [
              t[t.length - (k || 1)].range[0],
              t[t.length - 1].range[1]
            ]), ht = this.performAction.apply(C, [
              e2,
              St,
              H,
              I.yy,
              b[1],
              d2,
              t
            ].concat(xt)), typeof ht < "u")
              return ht;
            k && (o = o.slice(0, -1 * k * 2), d2 = d2.slice(0, -1 * k), t = t.slice(0, -1 * k)), o.push(this.productions_[b[1]][0]), d2.push(C.$), t.push(C._$), At = G[o[o.length - 2]][o[o.length - 1]], o.push(At);
            break;
          case 3:
            return true;
        }
      }
      return true;
    }, "parse")
  }, Rt = /* @__PURE__ */ function() {
    var R2 = {
      EOF: 1,
      parseError: /* @__PURE__ */ m(function(a, o) {
        if (this.yy.parser)
          this.yy.parser.parseError(a, o);
        else
          throw new Error(a);
      }, "parseError"),
      // resets the lexer, sets new input
      setInput: /* @__PURE__ */ m(function(n, a) {
        return this.yy = a || this.yy || {}, this._input = n, this._more = this._backtrack = this.done = false, this.yylineno = this.yyleng = 0, this.yytext = this.matched = this.match = "", this.conditionStack = ["INITIAL"], this.yylloc = {
          first_line: 1,
          first_column: 0,
          last_line: 1,
          last_column: 0
        }, this.options.ranges && (this.yylloc.range = [0, 0]), this.offset = 0, this;
      }, "setInput"),
      // consumes and returns one char from the input
      input: /* @__PURE__ */ m(function() {
        var n = this._input[0];
        this.yytext += n, this.yyleng++, this.offset++, this.match += n, this.matched += n;
        var a = n.match(/(?:\r\n?|\n).*/g);
        return a ? (this.yylineno++, this.yylloc.last_line++) : this.yylloc.last_column++, this.options.ranges && this.yylloc.range[1]++, this._input = this._input.slice(1), n;
      }, "input"),
      // unshifts one char (or a string) into the input
      unput: /* @__PURE__ */ m(function(n) {
        var a = n.length, o = n.split(/(?:\r\n?|\n)/g);
        this._input = n + this._input, this.yytext = this.yytext.substr(0, this.yytext.length - a), this.offset -= a;
        var r = this.match.split(/(?:\r\n?|\n)/g);
        this.match = this.match.substr(0, this.match.length - 1), this.matched = this.matched.substr(0, this.matched.length - 1), o.length - 1 && (this.yylineno -= o.length - 1);
        var d2 = this.yylloc.range;
        return this.yylloc = {
          first_line: this.yylloc.first_line,
          last_line: this.yylineno + 1,
          first_column: this.yylloc.first_column,
          last_column: o ? (o.length === r.length ? this.yylloc.first_column : 0) + r[r.length - o.length].length - o[0].length : this.yylloc.first_column - a
        }, this.options.ranges && (this.yylloc.range = [d2[0], d2[0] + this.yyleng - a]), this.yyleng = this.yytext.length, this;
      }, "unput"),
      // When called from action, caches matched text and appends it on next action
      more: /* @__PURE__ */ m(function() {
        return this._more = true, this;
      }, "more"),
      // When called from action, signals the lexer that this rule fails to match the input, so the next matching rule (regex) should be tested instead.
      reject: /* @__PURE__ */ m(function() {
        if (this.options.backtrack_lexer)
          this._backtrack = true;
        else
          return this.parseError("Lexical error on line " + (this.yylineno + 1) + `. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
` + this.showPosition(), {
            text: "",
            token: null,
            line: this.yylineno
          });
        return this;
      }, "reject"),
      // retain first n characters of the match
      less: /* @__PURE__ */ m(function(n) {
        this.unput(this.match.slice(n));
      }, "less"),
      // displays already matched input, i.e. for error messages
      pastInput: /* @__PURE__ */ m(function() {
        var n = this.matched.substr(0, this.matched.length - this.match.length);
        return (n.length > 20 ? "..." : "") + n.substr(-20).replace(/\n/g, "");
      }, "pastInput"),
      // displays upcoming input, i.e. for error messages
      upcomingInput: /* @__PURE__ */ m(function() {
        var n = this.match;
        return n.length < 20 && (n += this._input.substr(0, 20 - n.length)), (n.substr(0, 20) + (n.length > 20 ? "..." : "")).replace(/\n/g, "");
      }, "upcomingInput"),
      // displays the character position where the lexing error occurred, i.e. for error messages
      showPosition: /* @__PURE__ */ m(function() {
        var n = this.pastInput(), a = new Array(n.length + 1).join("-");
        return n + this.upcomingInput() + `
` + a + "^";
      }, "showPosition"),
      // test the lexed token: return FALSE when not a match, otherwise return token
      test_match: /* @__PURE__ */ m(function(n, a) {
        var o, r, d2;
        if (this.options.backtrack_lexer && (d2 = {
          yylineno: this.yylineno,
          yylloc: {
            first_line: this.yylloc.first_line,
            last_line: this.last_line,
            first_column: this.yylloc.first_column,
            last_column: this.yylloc.last_column
          },
          yytext: this.yytext,
          match: this.match,
          matches: this.matches,
          matched: this.matched,
          yyleng: this.yyleng,
          offset: this.offset,
          _more: this._more,
          _input: this._input,
          yy: this.yy,
          conditionStack: this.conditionStack.slice(0),
          done: this.done
        }, this.options.ranges && (d2.yylloc.range = this.yylloc.range.slice(0))), r = n[0].match(/(?:\r\n?|\n).*/g), r && (this.yylineno += r.length), this.yylloc = {
          first_line: this.yylloc.last_line,
          last_line: this.yylineno + 1,
          first_column: this.yylloc.last_column,
          last_column: r ? r[r.length - 1].length - r[r.length - 1].match(/\r?\n?/)[0].length : this.yylloc.last_column + n[0].length
        }, this.yytext += n[0], this.match += n[0], this.matches = n, this.yyleng = this.yytext.length, this.options.ranges && (this.yylloc.range = [this.offset, this.offset += this.yyleng]), this._more = false, this._backtrack = false, this._input = this._input.slice(n[0].length), this.matched += n[0], o = this.performAction.call(this, this.yy, this, a, this.conditionStack[this.conditionStack.length - 1]), this.done && this._input && (this.done = false), o)
          return o;
        if (this._backtrack) {
          for (var t in d2)
            this[t] = d2[t];
          return false;
        }
        return false;
      }, "test_match"),
      // return next match in input
      next: /* @__PURE__ */ m(function() {
        if (this.done)
          return this.EOF;
        this._input || (this.done = true);
        var n, a, o, r;
        this._more || (this.yytext = "", this.match = "");
        for (var d2 = this._currentRules(), t = 0; t < d2.length; t++)
          if (o = this._input.match(this.rules[d2[t]]), o && (!a || o[0].length > a[0].length)) {
            if (a = o, r = t, this.options.backtrack_lexer) {
              if (n = this.test_match(o, d2[t]), n !== false)
                return n;
              if (this._backtrack) {
                a = false;
                continue;
              } else
                return false;
            } else if (!this.options.flex)
              break;
          }
        return a ? (n = this.test_match(a, d2[r]), n !== false ? n : false) : this._input === "" ? this.EOF : this.parseError("Lexical error on line " + (this.yylineno + 1) + `. Unrecognized text.
` + this.showPosition(), {
          text: "",
          token: null,
          line: this.yylineno
        });
      }, "next"),
      // return next match that has a token
      lex: /* @__PURE__ */ m(function() {
        var a = this.next();
        return a || this.lex();
      }, "lex"),
      // activates a new lexer condition state (pushes the new lexer condition state onto the condition stack)
      begin: /* @__PURE__ */ m(function(a) {
        this.conditionStack.push(a);
      }, "begin"),
      // pop the previously active lexer condition state off the condition stack
      popState: /* @__PURE__ */ m(function() {
        var a = this.conditionStack.length - 1;
        return a > 0 ? this.conditionStack.pop() : this.conditionStack[0];
      }, "popState"),
      // produce the lexer rule set which is active for the currently active lexer condition state
      _currentRules: /* @__PURE__ */ m(function() {
        return this.conditionStack.length && this.conditionStack[this.conditionStack.length - 1] ? this.conditions[this.conditionStack[this.conditionStack.length - 1]].rules : this.conditions.INITIAL.rules;
      }, "_currentRules"),
      // return the currently active lexer condition state; when an index argument is provided it produces the N-th previous condition state, if available
      topState: /* @__PURE__ */ m(function(a) {
        return a = this.conditionStack.length - 1 - Math.abs(a || 0), a >= 0 ? this.conditionStack[a] : "INITIAL";
      }, "topState"),
      // alias for begin(condition)
      pushState: /* @__PURE__ */ m(function(a) {
        this.begin(a);
      }, "pushState"),
      // return the number of states currently on the stack
      stateStackSize: /* @__PURE__ */ m(function() {
        return this.conditionStack.length;
      }, "stateStackSize"),
      options: { "case-insensitive": true },
      performAction: /* @__PURE__ */ m(function(a, o, r, d2) {
        switch (r) {
          case 0:
            return this.begin("acc_title"), 24;
          case 1:
            return this.popState(), "acc_title_value";
          case 2:
            return this.begin("acc_descr"), 26;
          case 3:
            return this.popState(), "acc_descr_value";
          case 4:
            this.begin("acc_descr_multiline");
            break;
          case 5:
            this.popState();
            break;
          case 6:
            return "acc_descr_multiline_value";
          case 7:
            return 33;
          case 8:
            return 34;
          case 9:
            return 35;
          case 10:
            return 36;
          case 11:
            return 10;
          case 12:
            break;
          case 13:
            return 8;
          case 14:
            return 50;
          case 15:
            return 70;
          case 16:
            return 4;
          case 17:
            return this.begin("block"), 17;
          case 18:
            return 49;
          case 19:
            return 49;
          case 20:
            return 42;
          case 21:
            return 15;
          case 22:
            return 13;
          case 23:
            break;
          case 24:
            return 59;
          case 25:
            return 56;
          case 26:
            return 56;
          case 27:
            return 60;
          case 28:
            break;
          case 29:
            return this.popState(), 19;
          case 30:
            return o.yytext[0];
          case 31:
            return 20;
          case 32:
            return 21;
          case 33:
            return this.begin("style"), 44;
          case 34:
            return this.popState(), 10;
          case 35:
            break;
          case 36:
            return 13;
          case 37:
            return 42;
          case 38:
            return 49;
          case 39:
            return this.begin("style"), 37;
          case 40:
            return 43;
          case 41:
            return 63;
          case 42:
            return 65;
          case 43:
            return 65;
          case 44:
            return 65;
          case 45:
            return 63;
          case 46:
            return 63;
          case 47:
            return 64;
          case 48:
            return 64;
          case 49:
            return 64;
          case 50:
            return 64;
          case 51:
            return 64;
          case 52:
            return 65;
          case 53:
            return 64;
          case 54:
            return 65;
          case 55:
            return 66;
          case 56:
            return 66;
          case 57:
            return 66;
          case 58:
            return 66;
          case 59:
            return 63;
          case 60:
            return 64;
          case 61:
            return 65;
          case 62:
            return 67;
          case 63:
            return 68;
          case 64:
            return 69;
          case 65:
            return 69;
          case 66:
            return 68;
          case 67:
            return 68;
          case 68:
            return 68;
          case 69:
            return 41;
          case 70:
            return 47;
          case 71:
            return 40;
          case 72:
            return 48;
          case 73:
            return o.yytext[0];
          case 74:
            return 6;
        }
      }, "anonymous"),
      rules: [/^(?:accTitle\s*:\s*)/i, /^(?:(?!\n||)*[^\n]*)/i, /^(?:accDescr\s*:\s*)/i, /^(?:(?!\n||)*[^\n]*)/i, /^(?:accDescr\s*\{\s*)/i, /^(?:[\}])/i, /^(?:[^\}]*)/i, /^(?:.*direction\s+TB[^\n]*)/i, /^(?:.*direction\s+BT[^\n]*)/i, /^(?:.*direction\s+RL[^\n]*)/i, /^(?:.*direction\s+LR[^\n]*)/i, /^(?:[\n]+)/i, /^(?:\s+)/i, /^(?:[\s]+)/i, /^(?:"[^"%\r\n\v\b\\]+")/i, /^(?:"[^"]*")/i, /^(?:erDiagram\b)/i, /^(?:\{)/i, /^(?:#)/i, /^(?:#)/i, /^(?:,)/i, /^(?::::)/i, /^(?::)/i, /^(?:\s+)/i, /^(?:\b((?:PK)|(?:FK)|(?:UK))\b)/i, /^(?:([^\s]*)[~].*[~]([^\s]*))/i, /^(?:([\*A-Za-z_\u00C0-\uFFFF][A-Za-z0-9\-\_\[\]\(\)\u00C0-\uFFFF\*]*))/i, /^(?:"[^"]*")/i, /^(?:[\n]+)/i, /^(?:\})/i, /^(?:.)/i, /^(?:\[)/i, /^(?:\])/i, /^(?:style\b)/i, /^(?:[\n]+)/i, /^(?:\s+)/i, /^(?::)/i, /^(?:,)/i, /^(?:#)/i, /^(?:classDef\b)/i, /^(?:class\b)/i, /^(?:one or zero\b)/i, /^(?:one or more\b)/i, /^(?:one or many\b)/i, /^(?:1\+)/i, /^(?:\|o\b)/i, /^(?:zero or one\b)/i, /^(?:zero or more\b)/i, /^(?:zero or many\b)/i, /^(?:0\+)/i, /^(?:\}o\b)/i, /^(?:many\(0\))/i, /^(?:many\(1\))/i, /^(?:many\b)/i, /^(?:\}\|)/i, /^(?:one\b)/i, /^(?:only one\b)/i, /^(?:1\b)/i, /^(?:\|\|)/i, /^(?:o\|)/i, /^(?:o\{)/i, /^(?:\|\{)/i, /^(?:\s*u\b)/i, /^(?:\.\.)/i, /^(?:--)/i, /^(?:to\b)/i, /^(?:optionally to\b)/i, /^(?:\.-)/i, /^(?:-\.)/i, /^(?:([^\x00-\x7F]|\w|-|\*)+)/i, /^(?:;)/i, /^(?:([^\x00-\x7F]|\w|-|\*)+)/i, /^(?:[0-9])/i, /^(?:.)/i, /^(?:$)/i],
      conditions: { style: { rules: [34, 35, 36, 37, 38, 69, 70], inclusive: false }, acc_descr_multiline: { rules: [5, 6], inclusive: false }, acc_descr: { rules: [3], inclusive: false }, acc_title: { rules: [1], inclusive: false }, block: { rules: [23, 24, 25, 26, 27, 28, 29, 30], inclusive: false }, INITIAL: { rules: [0, 2, 4, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 31, 32, 33, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 71, 72, 73, 74], inclusive: true } }
    };
    return R2;
  }();
  ot.lexer = Rt;
  function q() {
    this.yy = {};
  }
  return m(q, "Parser"), q.prototype = ot, ot.Parser = q, new q();
}();
pt.parser = pt;
var Xt = pt, K, qt = (K = class {
  constructor() {
    this.entities = /* @__PURE__ */ new Map(), this.relationships = [], this.classes = /* @__PURE__ */ new Map(), this.direction = "TB", this.Cardinality = {
      ZERO_OR_ONE: "ZERO_OR_ONE",
      ZERO_OR_MORE: "ZERO_OR_MORE",
      ONE_OR_MORE: "ONE_OR_MORE",
      ONLY_ONE: "ONLY_ONE",
      MD_PARENT: "MD_PARENT"
    }, this.Identification = {
      NON_IDENTIFYING: "NON_IDENTIFYING",
      IDENTIFYING: "IDENTIFYING"
    }, this.setAccTitle = $5, this.getAccTitle = B5, this.setAccDescription = F5, this.getAccDescription = D5, this.setDiagramTitle = R5, this.getDiagramTitle = I5, this.getConfig = /* @__PURE__ */ m(() => yt().er, "getConfig"), this.clear(), this.addEntity = this.addEntity.bind(this), this.addAttributes = this.addAttributes.bind(this), this.addRelationship = this.addRelationship.bind(this), this.setDirection = this.setDirection.bind(this), this.addCssStyles = this.addCssStyles.bind(this), this.addClass = this.addClass.bind(this), this.setClass = this.setClass.bind(this), this.setAccTitle = this.setAccTitle.bind(this), this.setAccDescription = this.setAccDescription.bind(this);
  }
  /**
   * Add entity
   * @param name - The name of the entity
   * @param alias - The alias of the entity
   */
  addEntity(s, h = "") {
    var p;
    return this.entities.has(s) ? !((p = this.entities.get(s)) != null && p.alias) && h && (this.entities.get(s).alias = h, R.info(`Add alias '${h}' to entity '${s}'`)) : (this.entities.set(s, {
      id: `entity-${s}-${this.entities.size}`,
      label: s,
      attributes: [],
      alias: h,
      shape: "erBox",
      look: yt().look ?? "default",
      cssClasses: "default",
      cssStyles: []
    }), R.info("Added new entity :", s)), this.entities.get(s);
  }
  getEntity(s) {
    return this.entities.get(s);
  }
  getEntities() {
    return this.entities;
  }
  getClasses() {
    return this.classes;
  }
  addAttributes(s, h) {
    const p = this.addEntity(s);
    let l;
    for (l = h.length - 1; l >= 0; l--)
      h[l].keys || (h[l].keys = []), h[l].comment || (h[l].comment = ""), p.attributes.push(h[l]), R.debug("Added attribute ", h[l].name);
  }
  /**
   * Add a relationship
   *
   * @param entA - The first entity in the relationship
   * @param rolA - The role played by the first entity in relation to the second
   * @param entB - The second entity in the relationship
   * @param rSpec - The details of the relationship between the two entities
   */
  addRelationship(s, h, p, l) {
    const c = this.entities.get(s), y = this.entities.get(p);
    if (!c || !y)
      return;
    const f = {
      entityA: c.id,
      roleA: h,
      entityB: y.id,
      relSpec: l
    };
    this.relationships.push(f), R.debug("Added new relationship :", f);
  }
  getRelationships() {
    return this.relationships;
  }
  getDirection() {
    return this.direction;
  }
  setDirection(s) {
    this.direction = s;
  }
  getCompiledStyles(s) {
    let h = [];
    for (const p of s) {
      const l = this.classes.get(p);
      l != null && l.styles && (h = [...h, ...l.styles ?? []].map((c) => c.trim())), l != null && l.textStyles && (h = [...h, ...l.textStyles ?? []].map((c) => c.trim()));
    }
    return h;
  }
  addCssStyles(s, h) {
    for (const p of s) {
      const l = this.entities.get(p);
      if (!h || !l)
        return;
      for (const c of h)
        l.cssStyles.push(c);
    }
  }
  addClass(s, h) {
    s.forEach((p) => {
      let l = this.classes.get(p);
      l === void 0 && (l = { id: p, styles: [], textStyles: [] }, this.classes.set(p, l)), h && h.forEach(function(c) {
        if (/color/.exec(c)) {
          const y = c.replace("fill", "bgFill");
          l.textStyles.push(y);
        }
        l.styles.push(c);
      });
    });
  }
  setClass(s, h) {
    for (const p of s) {
      const l = this.entities.get(p);
      if (l)
        for (const c of h)
          l.cssClasses += " " + c;
    }
  }
  clear() {
    this.entities = /* @__PURE__ */ new Map(), this.classes = /* @__PURE__ */ new Map(), this.relationships = [], M5();
  }
  getData() {
    const s = [], h = [], p = yt();
    for (const c of this.entities.keys()) {
      const y = this.entities.get(c);
      y && (y.cssCompiledStyles = this.getCompiledStyles(y.cssClasses.split(" ")), s.push(y));
    }
    let l = 0;
    for (const c of this.relationships) {
      const y = {
        id: OI(c.entityA, c.entityB, {
          prefix: "id",
          counter: l++
        }),
        type: "normal",
        curve: "basis",
        start: c.entityA,
        end: c.entityB,
        label: c.roleA,
        labelpos: "c",
        thickness: "normal",
        classes: "relationshipLine",
        arrowTypeStart: c.relSpec.cardB.toLowerCase(),
        arrowTypeEnd: c.relSpec.cardA.toLowerCase(),
        pattern: c.relSpec.relType == "IDENTIFYING" ? "solid" : "dashed",
        look: p.look
      };
      h.push(y);
    }
    return { nodes: s, edges: h, other: {}, config: p, direction: "TB" };
  }
}, m(K, "ErDB"), K), Nt = {};
Qv(Nt, {
  draw: () => Ht
});
var Ht = /* @__PURE__ */ m(async function(i, s, h, p) {
  R.info("REF0:"), R.info("Drawing er diagram (unified)", s);
  const { securityLevel: l, er: c, layout: y } = yt(), f = p.db.getData(), E = g(s, l);
  f.type = p.type, f.layoutAlgorithm = XI(y), f.config.flowchart.nodeSpacing = (c == null ? void 0 : c.nodeSpacing) || 140, f.config.flowchart.rankSpacing = (c == null ? void 0 : c.rankSpacing) || 80, f.direction = p.db.getDirection(), f.markers = ["only_one", "zero_or_one", "one_or_more", "zero_or_more"], f.diagramId = s, await VI(f, E), f.layoutAlgorithm === "elk" && E.select(".edges").lower();
  const w = E.selectAll('[id*="-background"]');
  Array.from(w).length > 0 && w.each(function() {
    const S = gt(this), U = S.attr("id").replace("-background", ""), T = E.select(`#${CSS.escape(U)}`);
    if (!T.empty()) {
      const V = T.attr("transform");
      S.attr("transform", V);
    }
  });
  const Z = 8;
  $e.insertTitle(
    E,
    "erDiagramTitleText",
    (c == null ? void 0 : c.titleTopMargin) ?? 25,
    p.db.getDiagramTitle()
  ), d(E, Z, "erDiagram", (c == null ? void 0 : c.useMaxWidth) ?? true);
}, "draw"), Jt = /* @__PURE__ */ m((i, s) => {
  const h = e, p = h(i, "r"), l = h(i, "g"), c = h(i, "b");
  return dn(p, l, c, s);
}, "fade"), $t = /* @__PURE__ */ m((i) => `
  .entityBox {
    fill: ${i.mainBkg};
    stroke: ${i.nodeBorder};
  }

  .relationshipLabelBox {
    fill: ${i.tertiaryColor};
    opacity: 0.7;
    background-color: ${i.tertiaryColor};
      rect {
        opacity: 0.5;
      }
  }

  .labelBkg {
    background-color: ${Jt(i.tertiaryColor, 0.5)};
  }

  .edgeLabel .label {
    fill: ${i.nodeBorder};
    font-size: 14px;
  }

  .label {
    font-family: ${i.fontFamily};
    color: ${i.nodeTextColor || i.textColor};
  }

  .edge-pattern-dashed {
    stroke-dasharray: 8,8;
  }

  .node rect,
  .node circle,
  .node ellipse,
  .node polygon
  {
    fill: ${i.mainBkg};
    stroke: ${i.nodeBorder};
    stroke-width: 1px;
  }

  .relationshipLine {
    stroke: ${i.lineColor};
    stroke-width: 1;
    fill: none;
  }

  .marker {
    fill: none !important;
    stroke: ${i.lineColor} !important;
    stroke-width: 1;
  }
`, "getStyles"), te = $t, Ni = {
  parser: Xt,
  get db() {
    return new qt();
  },
  renderer: Nt,
  styles: te
};
export {
  Ni as diagram
};
